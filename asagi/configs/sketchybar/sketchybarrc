#!/bin/bash

# SketchyBar Configuration
# Based on reference setup with comprehensive widget support

PLUGIN_DIR="$HOME/.config/sketchybar/plugins"

# Color Palette
export BLACK=0xff181926
export WHITE=0xffffffff
export RED=0xffed8796
export GREEN=0xffa6da95
export BLUE=0xff8aadf4
export YELLOW=0xffeed49f
export ORANGE=0xfff5a97f
export MAGENTA=0xffc6a0f6
export GREY=0xff939ab7
export TRANSPARENT=0x00000000

# Bar Appearance
export BAR_COLOR=0xcc24273a
export ITEM_BG_COLOR=0xff363a4f
export ACCENT_COLOR=$BLUE

# Bar Configuration
sketchybar --bar height=32 \
                 blur_radius=30 \
                 position=top \
                 sticky=off \
                 padding_left=10 \
                 padding_right=10 \
                 color=$BAR_COLOR

# Default item settings
sketchybar --default icon.font="HackGen35 Console NF:Bold:17.0" \
                     icon.color=$WHITE \
                     label.font="HackGen35 Console NF:Bold:14.0" \
                     label.color=$WHITE \
                     padding_left=5 \
                     padding_right=5 \
                     label.padding_left=4 \
                     label.padding_right=4 \
                     icon.padding_left=4 \
                     icon.padding_right=4

# Left Side Items

# Apple Logo
sketchybar --add item apple.logo left \
           --set apple.logo icon= \
                            icon.font="HackGen35 Console NF:Bold:16.0" \
                            background.padding_left=5 \
                            background.padding_right=15 \
                            label.drawing=off \
                            click_script="$PLUGIN_DIR/apple.sh"

# Spaces (Virtual Desktops)
SPACE_ICONS=("1" "2" "3" "4" "5" "6" "7" "8" "9" "10")

for i in "${!SPACE_ICONS[@]}"
do
  sid=$(($i+1))
  sketchybar --add space space.$sid left \
             --set space.$sid associated_space=$sid \
                              icon=${SPACE_ICONS[i]} \
                              background.color=$ITEM_BG_COLOR \
                              background.corner_radius=5 \
                              background.height=20 \
                              background.drawing=off \
                              label.drawing=off \
                              script="$PLUGIN_DIR/spaces.sh" \
                              click_script="yabai -m space --focus $sid"
done

# Front App (Current Application)
sketchybar --add item front_app left \
           --set front_app background.color=$ACCENT_COLOR \
                           background.corner_radius=5 \
                           background.height=24 \
                           background.padding_left=10 \
                           icon.color=$WHITE \
                           icon.drawing=off \
                           label.color=$WHITE \
                           label.font="HackGen35 Console NF:Bold:13.0" \
                           script="$PLUGIN_DIR/front_app.sh" \
           --subscribe front_app front_app_switched

# Right Side Items

# Clock
sketchybar --add item clock right \
           --set clock update_freq=10 \
                       icon= \
                       script="$PLUGIN_DIR/clock.sh"

# Battery
sketchybar --add item battery right \
           --set battery update_freq=120 \
                         script="$PLUGIN_DIR/battery.sh" \
           --subscribe battery system_woke power_source_change

# Volume
sketchybar --add item volume right \
           --set volume script="$PLUGIN_DIR/volume.sh" \
           --subscribe volume volume_change

# CPU
sketchybar --add item cpu right \
           --set cpu update_freq=5 \
                     icon= \
                     script="$PLUGIN_DIR/cpu.sh"

# Network
sketchybar --add item network right \
           --set network update_freq=10 \
                         icon=ó°–© \
                         script="$PLUGIN_DIR/network.sh"

# Finalize
sketchybar --update
